View(spc_ma_fallop)
cor(spear_fallop_x, spear_fallop_y, method = "spearman")
x <- cor(spear_fallop_x, spear_fallop_y, method = "spearman")
cor(spc_ma_fallop, spc_fall, method="spearman")
cor(spear_imm_x, spear_imm_y, method = "spearman")
cor(spear_mesen_x, spear_mesen_y, method = "spearman")
cor(spear_prolif_x, spear_prolif_y, method="spearman")
cor(spear_imm_x, spear_fallop_y, method="spearman")
cor(spear_imm_x[1:499], spear_fallop_y, method="spearman")
ma_fallop_ranks <- data.frame(spc_ma_fallop$fma_rows, spc_ma_fallop$P.Value)
ma_immuno_ranks <- data.frame(ima_rows, spc_ma_imm$P.Value)
ma_immuno_ranks <- data.frame(spc_ma_imm$ima_rows, spc_ma_imm$P.Value)
ma_mesen_ranks <- data.frame(spc_ma_mesen$mma_rows, spc_ma_mesen)
ma_mesen_ranks <- data.frame(spc_ma_mesen$mma_rows, spc_ma_mesen$P.Value)
ma_prolif_ranks <- data.frame(spc_ma_prolif$pma_rows, spc_ma_prolif$P.Value)
ma_f_ranks <- data.frame(spc_ma_fallop$fma_rows, 1:length(spc_ma_fallop$fma_rows))
View(ma_f_ranks)
ma_f_ranks <- data.frame(geneName <- spc_ma_fallop$fma_rows, rank = 1:length(spc_ma_fallop$fma_rows))
View(ma_f_ranks)
ma_f_ranks <- data.frame(geneName = spc_ma_fallop$fma_rows, rank = 1:length(spc_ma_fallop$fma_rows))
View(ma_f_ranks)
ma_i_ranks <- data.frame(geneName = spc_ma_imm$ima_rows, rank = 1:length(spc_ma_imm$ima_rows))
ma_m_ranks <- data.frame(geneName = spc_ma_mesen$mma_rows, rank=1:length(spc_ma_mesen$mma_rows))
ma_p_ranks <- data.frame(geneName = spc_ma_prolif$pma_rows, rank= 1:length(spc_ma_prolif$pma_rows))
sq_f_ranks <- data.frame(geneName = spc_fall$V1, rank = 1:length(spc_fall$V1))
sq_i_ranks <- data.frame(geneName = spc_immuno$V1, rank= 1:length(spc_immuno$V1))
sq_m_ranks <- data.frame(genename = spc_mesen$V1, rank = 1:length(spc_mesen$V1))
sq_p_ranks <- data.frame(geneName = spc_prolif$V1, rank= 1:length(spc_prolif$V1))
View(sq_f_ranks)
sq_f_ranks
order(sq_f_ranks$ranks)
sq_f_ranks <- sq_f_ranks[order(sq_f_ranks$rank),]
View(sq_f_ranks)
View(sq_f_ranks)
View(ma_f_ranks)
ma_f_ranks <- data.frame(geneName = spc_ma_fallop$fma_rows, rank = 1:length(spc_ma_fallop$fma_rows), stringsAsFactors = FALSE)
ma_i_ranks <- data.frame(geneName = spc_ma_imm$ima_rows, rank = 1:length(spc_ma_imm$ima_rows),stringsAsFactors = FALSE)
ma_m_ranks <- data.frame(geneName = spc_ma_mesen$mma_rows, rank=1:length(spc_ma_mesen$mma_rows),stringsAsFactors = FALSE)
ma_p_ranks <- data.frame(geneName = spc_ma_prolif$pma_rows, rank= 1:length(spc_ma_prolif$pma_rows),stringsAsFactors = FALSE)
sq_f_ranks <- data.frame(geneName = spc_fall$V1, rank = 1:length(spc_fall$V1),stringsAsFactors = FALSE)
sq_i_ranks <- data.frame(geneName = spc_immuno$V1, rank= 1:length(spc_immuno$V1),stringsAsFactors = FALSE)
sq_m_ranks <- data.frame(genename = spc_mesen$V1, rank = 1:length(spc_mesen$V1),stringsAsFactors = FALSE)
sq_p_ranks <- data.frame(geneName = spc_prolif$V1, rank= 1:length(spc_prolif$V1),stringsAsFactors = FALSE)
View(sq_f_ranks)
sq_f_ranks <- sq_f_ranks[order(sq_f_ranks$rank),]
View(sq_f_ranks)
View(sq_i_ranks)
View(sq_f_ranks)
help(order)
library(dplyr)
library(doBy)
install.packages("doBy")
library(doBy)
help(orderBy)
sq_f_ranks <- sq_f_ranks[order(sq_f_ranks$geneName),]
View(sq_f_ranks)
sq_f_ranks <- sq_f_ranks[order(sq_f_ranks$geneName),]
ma_f_ranks <- ma_f_ranks[order(ma_f_ranks$geneName),]
ma_i_ranks <- ma_i_ranks[order(ma_i_ranks$geneName),]
ma_m_ranks <- ma_m_ranks[order(ma_m_ranks$geneName),]
ma_p_ranks <- ma_p_ranks[order(ma_p_ranks$geneName),]
sq_f_ranks <- sq_f_ranks[order(sq_f_ranks$geneName),]
sq_i_ranks <- sq_i_ranks[order(sq_i_ranks$geneName),]
sq_m_ranks <- sq_m_ranks[order(sq_m_ranks$genename),]
sq_p_ranks <- sq_p_ranks[order(sq_p_ranks$geneName),]
View(sq_f_ranks)
View(sq_i_ranks)
View(sq_m_ranks)
View(sq_p_ranks)
View(ma_f_ranks)
View(ma_f_ranks)
View(ma_i_ranks)
View(ma_m_ranks)
View(ma_p_ranks)
cor(ma_f_ranks$rank, sq_f_ranks$rank, method='spearman')
spearman <- data.frame(Subtype = c("Fallopian", "Immunoreactive", "Mesenchymal", "Proliferative"), Rho.Value = c(cor(ma_f_ranks$rank, sq_f_ranks$rank, method="spearman"), cor(ma_i_ranks$rank, sq_i_ranks$rank, method="spearman"), cor(ma_m_ranks$rank, sq_m_ranks$rank, method="spearman"), cor(ma_p_ranks$rank, sq_p_ranks$rank, method="spearman")) )
View(spearman)
write.table(spearman, "C:/Users/david/Documents/GitHub/KUMC_OvarianCancer_Feb2017/GeneSetAnalysis/spearman_correlation.txt", sep="\t", row.names = FALSE)
View(spc_fall)
View(p_list)
View(a_spc_fall)
View(spc_fall)
spc_fall <- data.frame(spc_fall, stringsAsFactors = FALSE)
spc_fall <- data.frame(spc_fall, stringsAsFactors = FALSE)
spc_immuno <- data.frame(spc_immuno, stringsAsFactors = FALSE)
spc_mesen <- data.frame(spc_mesen, stringsAsFactors = FALSE)
spc_prolif <- data.frame(spc_prolif, stringsAsFactors = FALSE)
spc_ma_fall <- data.frame(spc_ma_fall, stringsAsFactors = FALSE)
spc_ma_imm <- data.frame(spc_ma_imm, stringsAsFactors = FALSE)
spc_ma_mesen <- data.frame(spc_ma_mesen, stringsAsFactors = FALSE)
spc_ma_prolif <- data.frame(spc_ma_prolif, stringsAsFactors = FALSE)
spc_ma_fallop <- data.frame(spc_ma_fallop, stringsAsFactors = FALSE)
spcs_fall <- spc_fall[order(spc_fall$V1), spc_fall$PValue]
spcs_fall <- spc_fall[order(spc_fall$V1), ]
View(spcs_fall)
spc_fall <- spc_fall[order(spc_fall$V1), ]
spc_immuno <- spc_immuno[order(spc_immuno$V1),]
spc_mesen <- spc_mesen[order(spc_mesen$V1),]
spc_prolif <- spc_prolif[order(spc_prolif$V1),]
spc_ma_fallop <- spc_ma_fallop[order(spc_ma_fallop$fma_rows),]
spc_ma_imm <- spc_ma_imm[order(spc_ma_imm$ima_rows),]
spc_ma_mesen <- spc_ma_mesen[order(spc_ma_mesen$mma_rows),]
spc_ma_prolif <- spc_ma_prolif[order(spc_ma_prolif$pma_rows),]
View(spc_fall)
help(plot)
plot(spc_ma_fallop$P.Value, spc_fall$PValue, xlab = "Microarray p-values", ylab = "RNA-seq p-values", main="p-values for Differential Gene Expression in Fallopian Subtype Ovarian Cancer")
plot(spc_ma_imm$P.Value, spc_immuno$PValue, xlab = "Microarray  p-values", ylab = "RNA-seq p-values", main= "Microarray p-values vs RNA-seq p-values for DE in Immunoreactive Subtype Ovarian Cancer")
plot(spc_ma_mesen$P.Value, spc_mesen$PValue, xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Microarray p-values vs RNA-seq p-values for DE in Mesenchymal Subtype Ovarian Cancer")
plot(spc_ma_prolif$P.Value, spc_prolif$PValue, xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Microarray p-values vs RNA-seq p-values for DE in Proliferative Subtype Ovarian Cancer")
test <- spc_ma_fallop$fma_rows == spc_fall$V1
View(spc_fall)
View(spc_ma_fallop)
test <- spc_ma_fallop$fma_rows %in% spc_fall$V1
test
xf_plot <- subset(spc_ma_fall, spc_ma_fall$PValue <= 0.05)
yf_plot <- subset(spc_fall, spc_fall$PValue <= 0.05)
xi_plot <-subset(spc_ma_imm, spc_ma_imm$P.Value <= 0.05)
yi_plot <-subset(spc_immuno, spc_immuno$PValue <= 0.05)
xm_plot <- subset(spc_ma_mesen, spc_ma_mesen$P.Value <= 0.05)
ym_plot <- subset(spc_mesen, spc_mesen$PValue, <= 0.05)
xp_plot <- subset(spc_ma_prolif, spc_ma_prolif$P.Value <=0.05)
yp_plot<- subset(spc_prolif, spc_prolif$PValue <= 0.05)
#plotting p values
plot(xf_plot$P.Value, yf_plot$PValue, xlab = "Microarray p-values", ylab = "RNA-seq p-values", main="Fallopian Subtype Ovarian Cancer")
plot(xi_plot$P.Value, yi_plot$PValue, xlab = "Microarray  p-values", ylab = "RNA-seq p-values", main= "Immunoreactive Subtype Ovarian Cancer")
plot(xm_plot$P.Value, ym_plot$PValue, xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Mesenchymal Subtype Ovarian Cancer")
plot(xp_plot$P.Value, yp_plot$PValue, xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Proliferative Subtype Ovarian Cancer")
View(yi_plot)
plot(spc_ma_fallop$P.Value, spc_fall$PValue, xlab = "Microarray p-values", ylab = "RNA-seq p-values", main="Fallopian Subtype Ovarian Cancer")
plot(spc_ma_imm$P.Value, spc_immuno$PValue, xlab = "Microarray  p-values", ylab = "RNA-seq p-values", main= "Immunoreactive Subtype Ovarian Cancer")
plot(spc_ma_mesen$P.Value, spc_mesen$PValue, xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Mesenchymal Subtype Ovarian Cancer")
plot(spc_ma_prolif$P.Value, spc_prolif$PValue, xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Proliferative Subtype Ovarian Cancer")
#computing spearman correlation
xm_plot <- subset(spc_ma_mesen, spc_ma_mesen$P.Value <= 0.05)
ym_plot <- subset(spc_mesen, spc_mesen$PValue <= 0.05)
xi_plot <- subset(xi_plot, xi_plot$ima_rows %in% yi_plot$V1)
xm_plot <- subset(xm_plot, xm_plot$mma_rows %in% ym_plot$V1)
xp_plot <- subset(xp_plot, xp_plot$pma_rows %in% yp_plot$V1)
xf_plot <- subset(spc_ma_fallop, spc_ma_fallop$P.Value <= 0.05)
xf_plot <- subset(xf_plot, xf_plot$fma_rows %in% yf_plot$V1)
plot(xf_plot$P.Value, yf_plot$PValue, xlab = "Microarray p-values", ylab = "RNA-seq p-values", main="Fallopian Subtype Ovarian Cancer")
plot(xi_plot$P.Value, yi_plot$PValue, xlab = "Microarray  p-values", ylab = "RNA-seq p-values", main= "Immunoreactive Subtype Ovarian Cancer")
plot(xm_plot$P.Value, ym_plot$PValue, xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Mesenchymal Subtype Ovarian Cancer")
plot(xp_plot$P.Value, yp_plot$PValue, xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Proliferative Subtype Ovarian Cancer")
spc_fallop <- subset(fallop_de, fallop_de$v1 %in% row.names(f_fallopian_output) and fallop_de$PValue <= 0.05)
spc_immuno <- subset(immuno_de, immuno_de$V1 %in% row.names(f_immunoreactive_output) and immuno_de$PValue <= 0.05)
spc_mesen <- subset(mesen_de, mesen_de$V1 %in% row.names(f_mesenchymal_output) and mesen_de$PValue <= 0.05)
spc_prolif <- subset(prolif_de, prolif_de$V1 %in% row.names(f_proliferative_output) and prolif_de$PValue <= 0.05)
spc_ma_fallop <- subset(f_fallopian_output, f_fallopian_output$fma_rows %in% spc_fall$V1)
spc_ma_imm <- subset(f_immunoreactive_output, f_immunoreactive_output$ima_rows %in% spc_immuno$V1)
spc_ma_mesen <- subset(f_mesenchymal_output, f_mesenchymal_output$mma_rows %in% spc_mesen$V1)
spc_ma_prolif <- subset(f_proliferative_output, f_proliferative_output$pma_rows %in% spc_prolif$V1)
spc_fall <- data.frame(spc_fall, stringsAsFactors = FALSE)
spc_immuno <- data.frame(spc_immuno, stringsAsFactors = FALSE)
spc_mesen <- data.frame(spc_mesen, stringsAsFactors = FALSE)
spc_prolif <- data.frame(spc_prolif, stringsAsFactors = FALSE)
spc_ma_fall <- data.frame(spc_ma_fall, stringsAsFactors = FALSE)
spc_ma_imm <- data.frame(spc_ma_imm, stringsAsFactors = FALSE)
spc_ma_mesen <- data.frame(spc_ma_mesen, stringsAsFactors = FALSE)
spc_ma_prolif <- data.frame(spc_ma_prolif, stringsAsFactors = FALSE)
spc_fall <- spc_fall[order(spc_fall$V1), ]
spc_immuno <- spc_immuno[order(spc_immuno$V1),]
spc_mesen <- spc_mesen[order(spc_mesen$V1),]
spc_prolif <- spc_prolif[order(spc_prolif$V1),]
spc_ma_fallop <- spc_ma_fallop[order(spc_ma_fallop$fma_rows),]
spc_ma_imm <- spc_ma_imm[order(spc_ma_imm$ima_rows),]
spc_ma_mesen <- spc_ma_mesen[order(spc_ma_mesen$mma_rows),]
spc_ma_prolif <- spc_ma_prolif[order(spc_ma_prolif$pma_rows),]
xf_plot <- subset(spc_ma_fall, spc_ma_fall$PValue <= 0.05)
yf_plot <- subset(spc_fall, spc_fall$PValue <= 0.05)
xi_plot <-subset(spc_ma_imm, spc_ma_imm$P.Value <= 0.05)
yi_plot <-subset(spc_immuno, spc_immuno$PValue <= 0.05)
xm_plot <- subset(spc_ma_mesen, spc_ma_mesen$P.Value <= 0.05)
ym_plot <- subset(spc_mesen, spc_mesen$PValue, <= 0.05)
xp_plot <- subset(spc_ma_prolif, spc_ma_prolif$P.Value <=0.05)
yp_plot<- subset(spc_prolif, spc_prolif$PValue <= 0.05)
View(ma_fallop)
View(xf_plot)
View(yf_plot)
tyf <- yf_plot$PValue
tyf <- data.frame(tyf)
View(tyf)
help("log")
tyf <- log(tyf)
txf <- log(xf_plot$P.Value)
txf <- data.frame(txf)
View(txf)
plot(txf, tyf, xlab="Microarray P-Values", ylab = "RNA-seq p-values", main= "Fallopian Subtype")
plot(txf, tyf)
plot(txf$txf, tyf$tyf)
plot(log(xi_plot$P.Value), log(yi_plot$PValue))
View(xi_plot)
library(limma)
View(xi_plot)
xi_plot <-subset(spc_ma_imm, spc_ma_imm$P.Value <= 0.05)
yi_plot <-subset(spc_immuno, spc_immuno$PValue <= 0.05)
xm_plot <- subset(spc_ma_mesen, spc_ma_mesen$P.Value <= 0.05)
ym_plot <- subset(spc_mesen, spc_mesen$PValue, <= 0.05)
xp_plot <- subset(spc_ma_prolif, spc_ma_prolif$P.Value <=0.05)
yp_plot<- subset(spc_prolif, spc_prolif$PValue <= 0.05)
xi_plot <-subset(spc_ma_imm, spc_ma_imm$P.Value <= 0.05)
yi_plot <-subset(spc_immuno, spc_immuno$PValue <= 0.05)
xm_plot <- subset(spc_ma_mesen, spc_ma_mesen$P.Value <= 0.05)
ym_plot <- subset(spc_mesen, spc_mesen$PValue <= 0.05)
xp_plot <- subset(spc_ma_prolif, spc_ma_prolif$P.Value <=0.05)
yp_plot<- subset(spc_prolif, spc_prolif$PValue <= 0.05)
View(yi_plot)
View(xi_plot)
txi_plot <- subset(xi_plot,  xi_plot$ima_rows %in% yi_plot$V1)
plot(log(txi_plot$P.Value), log(yi_plot$PValue))
txm_plot <- subset(xm_plot, xm_plot$mma_rows %in% ym_plot$V1)
txp_plot <- subset(xp_plot, xp_plot$pma_rows %in% yp_plot$V1)
plot(log(txm_plot$P.Value), log(xm_plot$P.Value), main="Proliferative")
plot(log(txm_plot$P.Value), log(ym_plot$P.Value), main="Proliferative")
plot(log(txm_plot$P.Value), log(ym_plot$P.Value), main="Proliferative")
class(ym_plot$PValue)
class(txm_plot$P.Value)
plot(log(txm_plot$P.Value), log(ym_plot$P.Value))
class(ym_plot$PValue)
plot(log(txm_plot$P.Value), log(ym_plot$PValue))
plot(log(txp_plot$P.Value), log(yp_plot$PValue))
xf_plot <- subset(spc_ma_fall, spc_ma_fall$PValue <= 0.05)
yf_plot <- subset(spc_fall, spc_fall$PValue <= 0.05)
xf_plot <- subset(xf_plot, xf_plot$fma_rows %in% yf_plot$V1)
xi_plot <-subset(spc_ma_imm, spc_ma_imm$P.Value <= 0.05)
yi_plot <-subset(spc_immuno, spc_immuno$PValue <= 0.05)
xi_plot <- subset(xi_plot, xi_plot$ima_rows %in% yi_plot$V1)
xm_plot <- subset(spc_ma_mesen, spc_ma_mesen$P.Value <= 0.05)
ym_plot <- subset(spc_mesen, spc_mesen$PValue <= 0.05)
xm_plot <- subset(xm_plot, xm_plot$mma_rows %in% ym_plot$V1)
xp_plot <- subset(spc_ma_prolif, spc_ma_prolif$P.Value <=0.05)
yp_plot<- subset(spc_prolif, spc_prolif$PValue <= 0.05)
xp_plot <- subset(xp_plot, xp_plot$pma_rows %in% yp_plot$V1)
#plotting log(p values)
plot(log(xf_plot$P.Value), log(yf_plot$PValue), xlab = "Microarray p-values", ylab = "RNA-seq p-values", main="Fallopian Subtype Ovarian Cancer")
plot(log(xi_plot$P.Value), log(yi_plot$PValue), xlab = "Microarray  p-values", ylab = "RNA-seq p-values", main= "Immunoreactive Subtype Ovarian Cancer")
plot(log(xm_plot$P.Value), log(ym_plot$PValue), xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Mesenchymal Subtype Ovarian Cancer")
plot(log(xp_plot$P.Value), log(yp_plot$PValue), xlab= "Microarray p-values", ylab= "RNA-seq p-values", main="Proliferative Subtype Ovarian Cancer")
getwd()
setwd("C:/Users/david/Documents/GitHub/TCGAvsHPA/")
getwd()
ls
ls()
setwd("C:/Users/david/Documents/GitHub/TCGAvsHPA")
getwd()
ls
ls(0)
ls()
objNames <- c( "pnas_bladder", "pnas_breast", "pnas_liver", "pnas_prostate")
fileNames <- list.files()
dataList <- lapply(fileNames, read.delim)
names(dataList) <- objNames
objNames <- c( "bioX", "pnas_bladder", "pnas_breast", "pnas_liver", "pnas_prostate")
fileNames <- list.files()
dataList <- lapply(fileNames, read.delim)
names(dataList) <- objNames
View(dataList$bioX)
names(bioX)
names(dataList$bioX)
bx_bladder <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BLCA")
bx_breast <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BRCA")
bx_liver <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "LIHC")
bx_prostate <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "PRAD")
View(bx_prostate)
view(dataList$pnas_prostate)
View(dataList$pnas_prostate)
bx_bladder <- na.omit(bx_bladder)
bx_breast <- na.omit(bx_breast)
bx_liver <- na.omit(bx_liver)
bx_prostate <- na.omit(bx_prostate)
dataList <- lapply(dataList, na.omit)
View(dataList$pnas_prostate)
row.names(dataList$pnas_prostate)
dataList$pnas_prostate <- dataList$pnas_prostate[-c(1)]
View(dataList$pnas_prostate)
objNames <- c( "bioX", "pnas_bladder", "pnas_breast", "pnas_liver", "pnas_prostate")
fileNames <- list.files()
dataList <- lapply(fileNames, function(x){read.delim(x, as.is = TRUE)})
dataList <- lapply(dataList, na.omit)
names(dataList) <- objNames
bx_bladder <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BLCA")
bx_breast <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BRCA")
bx_liver <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "LIHC")
bx_prostate <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "PRAD")
View(dataList$pnas_prostate)
View(dataList$pnas_bladder)
bxgl_prost <- dataList$pnas_bladder$X
bxgl_prost <- bxgl_prost[-2]
bxgl_prost <- bxgl_prost[-1]
bxgl_prost <- dataList$pnas_bladder$X.1
bxgl_prost <- bxgl_prost[-1]
bxgl_prost <- bxgl_prost[-2]
bxgl_prost <- dataList$pnas_bladder$X.1
bxgl_prost <- bxgl_prost[-1]
bxgl_prost <- bxgl_prost[-1]
bx_prostate <- subset(bx_prostate, bx_prostate$Gene != '-')
bx_bladder <- subset(bx_bladder, bx_bladder$Gene != '-')
bx_breast <- subset(bx_breast, bx_breast$Gene != '-')
bx_liver <- subset(bx_liver, bx_liver$Gene != '-')
View(bx_bladder)
View(bx_prostate)
bxgl_prost <- bx_prostate$Gene
bxgl_liver <- bx_liver$Gene
bxgl_bladder <- bx_bladder$Gene
bxgl_breast <- bx_breast$Gene
p_bladder <- subset(dataList$pnas_bladder, dataList$pnas_bladder$X.1 %in% bxgl_bladder)
p_liver <- subset(dataList$pnas_liver, dataList$pnas_liver$X.1 %in% bxgl_liver)
p_breast <- subset(dataList$pnas_breast, dataList$pnas_breast$X.1 %in% bxgl_breast)
p_prostate <- subset(dataList$pnas_prostate, dataList$pnas_prostate$X.1 %in% bxgl_prost)
bx_bladder <- subset(bx_bladder, bx_bladder$Gene %in% p_bladder$X.1)
bx_breast <- subset(bx_breast, bx_breast$Gene %in% p_breast$X.1)
bx_liver <- subset(bx_liver, bx_liver$Gene %in% p_liver)
bx_prostate <- subset(bx_prostate, bx_prostate$Gene %in% p_prostate)
bx_liver <- subset(bx_liver, bx_liver$Gene %in% bxgl_liver)
rm(bx_liver, bx_prostate)
bx_liver <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "LIHC")
bx_prostate <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "PRAD")
bx_liver <- subset(bx_liver, bx_liver$Gene %in% bxgl_liver)
bx_liver <- subset(bx_prostate, bx_prostate$Gene %in% bxgl_liver)
View(bx_prostate)
View(bx_liver)
objNames <- c( "bioX", "pnas_bladder", "pnas_breast", "pnas_liver", "pnas_prostate")
fileNames <- list.files()
dataList <- lapply(fileNames, function(x){read.delim(x, as.is = TRUE)})
dataList <- lapply(dataList, na.omit)
names(dataList) <- objNames
bx_bladder <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BLCA")
bx_breast <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BRCA")
bx_liver <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "LIHC")
bx_prostate <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "PRAD")
View(bx_bladder)
View(bx_prostate)
bx_bladder <- subset(bx_bladder, bx_bladder$Gene %in% dataList$pnas_bladder$Gene.Name)
bx_breast <- subset(bx_breast, bx_breast$Gene %in% dataList$pnas_breast$Gene.Name)
bx_liver <- subset(bx_liver, bx_liver$Gene %in% dataList$pnas_liver$Gene.Name)
bx_prostate <- subset(bx_prostate, bx_prostate$Gene %in% dataList$pnas_prostate$Gene.Name)
bx_breast <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BRCA")
objNames <- c( "bioX", "pnas_bladder", "pnas_breast", "pnas_liver", "pnas_prostate")
fileNames <- list.files()
dataList <- lapply(fileNames, function(x){read.delim(x, as.is = TRUE)})
dataList <- lapply(dataList, na.omit)
names(dataList) <- objNames
#subsetting bioX data to relevant cancer types
bx_bladder <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BLCA")
bx_breast <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BRCA")
bx_liver <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "LIHC")
bx_prostate <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "PRAD")
#subsetting subsetting bx_cancerType data to PNAS gene lists
bx_bladder <- subset(bx_bladder, bx_bladder$Gene %in% dataList$pnas_bladder$Gene.Name)
bx_breast <- subset(bx_breast, bx_breast$Gene %in% dataList$pnas_breast$Gene.Name)
bx_liver <- subset(bx_liver, bx_liver$Gene %in% dataList$pnas_liver$Gene.Name)
bx_prostate <- subset(bx_prostate, bx_prostate$Gene %in% dataList$pnas_prostate$Gene.Name)
View(dataList$pnas_bladder)
View(dataList$pnas_breast)
View(dataList$pnas_liver)
View(dataList$pnas_prostate)
bx_bladder <- subset(bx_bladder, bx_bladder$Gene != '-')
bx_breast <- subset(bx_breast, bx_bladder$Gene != '-')
bx_liver <- subset(bx_liver, bx_bladder$Gene != '-')
bx_prostate <- subset(bx_prostate, bx_bladder$Gene != '-')
View(bx_bladder)
View(bx_bladder)
View(bx_bladder)
View(bx_bladder)
View(bx_liver)
View(bx_liver)
bx_dataList <- list(bx_bladder, bx_breast, bx_liver, bx_prostate)
names(bx_dataList) <- c("bxp_bladder", "bxp_breast", "bxp_liver", "bxp_prostate")
help(order)
order(c(18, 21, 33, 1, 2, 5, 1729))
help(sort)
sort(c(18, 21, 33, 1, 2, 5, 1729), decreasing = TRUE)
sort(bx_dataList$bxp_bladder$p_value)
order(bx_bladder$p_value)
order(bx_bladder)
geneLists <-list(bx_bladder$Gene, bx_breast$Gene, bx_liver$Gene, bx_prostate$Gene, dataList$pnas_bladder$Gene.Name, dataList$pnas_breast$Gene.Name, dataList$pnas_liver$Gene.Name, dataList$pnas_prostate$Gene.Name)
outFileNames <-c("glbx_bladder.txt", "glbx_breast.txt", "glbx_liver.txt", "glbx_prostate.txt", "glpnas_bladder.txt", "glpnas_breast.txt", "glpnas_liver.txt", "glpnas_prostate.txt")
c_bladder <- dataList$pnas_bladder$Gene.Name[!bx_bladder$Gene]
l_bladder <- bx_bladder$Gene %in% dataList$pnas_bladder$Gene.Name
l_breast <- bx_breast$Gene %in% dataList$pnas_breast$Gene.Name
l_liver <- bx_liver$Gene %in% dataList$pnas_liver$Gene.Name
l_prostate <- bx_prostate$Gene %in% dataList$pnas_prostate$Gene.Name
c_bladder <- dataList$pnas_bladder$Gene.Name[!l_bladder]
c_breast <- dataList$pnas_breast$Gene.Name[!l_breast]
c_liver <- dataList$pnas_liver$Gene.Name[!l_liver]
c_prostate <- dataList$pnas_prostate$Gene.Name[!l_prostate]
l_bladder <- dataList$pnas_bladder$Gene.Name %in% bx_bladder$Gene
l_breast <-  dataList$pnas_breast$Gene.Name %in% bx_breast$Gene
l_liver <- dataList$pnas_liver$Gene.Name %in% bx_liver$Gene
l_prostate <- dataList$pnas_prostate$Gene.Name %in% bx_prostate$Gene
c_bladder <- dataList$pnas_bladder$Gene.Name[!l_bladder]
c_breast <- dataList$pnas_breast$Gene.Name[!l_breast]
c_liver <- dataList$pnas_liver$Gene.Name[!l_liver]
c_prostate <- dataList$pnas_prostate$Gene.Name[!l_prostate]
help(and)
help(&)
l_bladder <- dataList$pnas_bladder$Gene.Name %in% bx_bladder$Gene & dataList$pnas_bladder != '-'
l_breast <-  dataList$pnas_breast$Gene.Name %in% bx_breast$Gene & dataList$pnas_breast != '-'
l_liver <- dataList$pnas_liver$Gene.Name %in% bx_liver$Gene  & dataList$pnas_liver != '-'
l_prostate <- dataList$pnas_prostate$Gene.Name %in% bx_prostate$Gene  & dataList$pnas_prostate != '-'
c_bladder <- dataList$pnas_bladder$Gene.Name[!l_bladder]
c_breast <- dataList$pnas_breast$Gene.Name[!l_breast]
c_liver <- dataList$pnas_liver$Gene.Name[!l_liver]
c_prostate <- dataList$pnas_prostate$Gene.Name[!l_prostate]
cpnas_liver <- subset(dataList$pnas_liver, (!(dataList$pnas_liver$Gene.Name %in% bx_liver$Gene)))
View(cpnas_liver)
cpnas_bladder<- subset(dataList$pnas_bladder, (!(dataList$pnas_bladder$Gene.Name %in% bx_bladder$Gene)))
cpnas_breast <- subset(dataList$pnas_breast, (!(dataList$pnas_breast$Gene.Name %in% bx_breast$Gene)))
cpnas_liver <- subset(dataList$pnas_liver, (!(dataList$pnas_liver$Gene.Name %in% bx_liver$Gene)))
cpnas_prostate <- subset(dataList$pnas_prostate, (!(dataList$pnas_prostate$Gene.Name %in% bx_prostate$Gene)))
View(geneLists[4])
help(lapply)
help(write.table)
lapply(1:8, function(x){write.table(geneLists[x], file=outFileNames[x], sep="\t")})
lapply(1:8, function(x){write.table(geneLists[x], file=outFileNames[x], sep="\t", col.names = FALSE, row.names = FALSE)})
rbx_bladder <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BLCA")
rbx_breast <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BRCA")
rbx_liver <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "LIHC")
rbx_prostate <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "PRAD")
View(rbx_bladder)
rbx_bladder <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BLCA" & dataList$bioX$p_value <= 0.05)
rbx_breast <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BRCA" & dataList$bioX$p_value <= 0.05)
rbx_liver <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "LIHC" & dataList$bioX$p_value <= 0.05)
rbx_prostate <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "PRAD" & dataList$bioX$p_value <= 0.05)
View(rbx_bladder)
cpnas_bladder<- subset(dataList$pnas_bladder, (!(dataList$pnas_bladder$Gene.Name %in% rbx_bladder$Gene)))
cpnas_breast <- subset(dataList$pnas_breast, (!(dataList$pnas_breast$Gene.Name %in% rbx_breast$Gene)))
cpnas_liver <- subset(dataList$pnas_liver, (!(dataList$pnas_liver$Gene.Name %in% rbx_liver$Gene)))
cpnas_prostate <- subset(dataList$pnas_prostate, (!(dataList$pnas_prostate$Gene.Name %in% rbx_prostate$Gene)))
geneLists <-list(rbx_bladder$Gene, rbx_breast$Gene, rbx_liver$Gene, rbx_prostate$Gene, dataList$pnas_bladder$Gene.Name, dataList$pnas_breast$Gene.Name, dataList$pnas_liver$Gene.Name, dataList$pnas_prostate$Gene.Name)
lapply(1:8, function(x){write.table(geneLists[x], file=outFileNames[x], sep="\t", col.names = FALSE, row.names = FALSE)})
objNames <- c( "bioX", "pnas_bladder", "pnas_breast", "pnas_liver", "pnas_prostate")
fileNames <- list.files()
dataList <- lapply(fileNames, function(x){read.delim(x, as.is = TRUE)})
dataList <- lapply(dataList, na.omit)
names(dataList) <- objNames
#subsetting bioX data to relevant cancer types
#name scheme is of the form <sourceAbbrev><status>_<cancerType> eg bx_bladder is unprocessed bioXpress bladder cancer data
rbx_bladder <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BLCA" & dataList$bioX$p_value <= 0.05)
rbx_breast <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BRCA" & dataList$bioX$p_value <= 0.05)
rbx_liver <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "LIHC" & dataList$bioX$p_value <= 0.05)
rbx_prostate <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "PRAD" & dataList$bioX$p_value <= 0.05)
#subsetting subsetting bx_cancerType data to PNAS gene lists
#bx_bladder <- subset(rbx_bladder, bx_bladder$Gene %in% dataList$pnas_bladder$Gene.Name)
#bx_breast <- subset(rbx_breast, bx_breast$Gene %in% dataList$pnas_breast$Gene.Name)
#bx_liver <- subset(rbx_liver, bx_liver$Gene %in% dataList$pnas_liver$Gene.Name)
#bx_prostate <- subset(rbx_prostate, bx_prostate$Gene %in% dataList$pnas_prostate$Gene.Name)
cpnas_bladder<- subset(dataList$pnas_bladder, (!(dataList$pnas_bladder$Gene.Name %in% rbx_bladder$Gene)))
cpnas_breast <- subset(dataList$pnas_breast, (!(dataList$pnas_breast$Gene.Name %in% rbx_breast$Gene)))
cpnas_liver <- subset(dataList$pnas_liver, (!(dataList$pnas_liver$Gene.Name %in% rbx_liver$Gene)))
cpnas_prostate <- subset(dataList$pnas_prostate, (!(dataList$pnas_prostate$Gene.Name %in% rbx_prostate$Gene)))
cpnas_bladder<- subset(dataList$pnas_bladder, cpnas_bladder$Gene.Name != '-')
cpnas_breast <- subset(dataList$pnas_breast, cpnas_bladder$Gene.Name != '-')
cpnas_liver <- subset(dataList$pnas_liver, cpnas_bladder$Gene.Name != '-')
cpnas_prostate <- subset(dataList$pnas_prostate, cpnas_bladder$Gene.Name != '-')
geneLists <-list(rbx_bladder$Gene, rbx_breast$Gene, rbx_liver$Gene, rbx_prostate$Gene, dataList$pnas_bladder$Gene.Name, dataList$pnas_breast$Gene.Name, dataList$pnas_liver$Gene.Name, dataList$pnas_prostate$Gene.Name)
lapply(1:8, function(x){write.table(geneLists[x], file=outFileNames[x], sep="\t", col.names = FALSE, row.names = FALSE)})
outFileNames <-c("glbx_bladder.txt", "glbx_breast.txt", "glbx_liver.txt", "glbx_prostate.txt", "glpnas_bladder.txt", "glpnas_breast.txt", "glpnas_liver.txt", "glpnas_prostate.txt")
lapply(1:8, function(x){write.table(geneLists[x], file=outFileNames[x], sep="\t", col.names = FALSE, row.names = FALSE)})
objNames <- c( "bioX", "pnas_bladder", "pnas_breast", "pnas_liver", "pnas_prostate")
fileNames <- list.files()
outFileNames <-c("glbx_bladder.txt", "glbx_breast.txt", "glbx_liver.txt", "glbx_prostate.txt", "glpnas_bladder.txt", "glpnas_breast.txt", "glpnas_liver.txt", "glpnas_prostate.txt")
dataList <- lapply(fileNames, function(x){read.delim(x, as.is = TRUE)})
dataList <- lapply(dataList, na.omit)
names(dataList) <- objNames
#subsetting bioX data to relevant cancer types
#name scheme is of the form <sourceAbbrev><status>_<cancerType> eg bx_bladder is unprocessed bioXpress bladder cancer data
rbx_bladder <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BLCA" & dataList$bioX$p_value <= 0.05)
rbx_breast <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "BRCA" & dataList$bioX$p_value <= 0.05)
rbx_liver <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "LIHC" & dataList$bioX$p_value <= 0.05)
rbx_prostate <- subset(dataList$bioX, dataList$bioX$TCGA.Cancer == "PRAD" & dataList$bioX$p_value <= 0.05)
#subsetting subsetting bx_cancerType data to PNAS gene lists
#bx_bladder <- subset(rbx_bladder, bx_bladder$Gene %in% dataList$pnas_bladder$Gene.Name)
#bx_breast <- subset(rbx_breast, bx_breast$Gene %in% dataList$pnas_breast$Gene.Name)
#bx_liver <- subset(rbx_liver, bx_liver$Gene %in% dataList$pnas_liver$Gene.Name)
#bx_prostate <- subset(rbx_prostate, bx_prostate$Gene %in% dataList$pnas_prostate$Gene.Name)
cpnas_bladder<- subset(dataList$pnas_bladder, (!(dataList$pnas_bladder$Gene.Name %in% rbx_bladder$Gene)))
cpnas_breast <- subset(dataList$pnas_breast, (!(dataList$pnas_breast$Gene.Name %in% rbx_breast$Gene)))
cpnas_liver <- subset(dataList$pnas_liver, (!(dataList$pnas_liver$Gene.Name %in% rbx_liver$Gene)))
cpnas_prostate <- subset(dataList$pnas_prostate, (!(dataList$pnas_prostate$Gene.Name %in% rbx_prostate$Gene)))
cpnas_bladder<- subset(dataList$pnas_bladder, cpnas_bladder$Gene.Name != '-')
cpnas_breast <- subset(dataList$pnas_breast, cpnas_bladder$Gene.Name != '-')
cpnas_liver <- subset(dataList$pnas_liver, cpnas_bladder$Gene.Name != '-')
cpnas_prostate <- subset(dataList$pnas_prostate, cpnas_bladder$Gene.Name != '-')
geneLists <-list(rbx_bladder$Gene, rbx_breast$Gene, rbx_liver$Gene, rbx_prostate$Gene, dataList$pnas_bladder$Gene.Name, dataList$pnas_breast$Gene.Name, dataList$pnas_liver$Gene.Name, dataList$pnas_prostate$Gene.Name)
lapply(1:8, function(x){write.table(geneLists[x], file=outFileNames[x], sep="\t", col.names = FALSE, row.names = FALSE)})
union_lists <-lapply(1:8, function(x){merge(geneLists[x], geneLists[x+4])})
union_lists <-lapply(1:4, function(x){merge(geneLists[x], geneLists[x+4])})
View(union_lists[1])
rm(union_lists)
help(unlist)
ul_bladder <- list(geneLists[1], geneLists[5])
ul_breast <- list(geneLists[2], geneLists[6])
ul_liver <- list(geneLists[3], geneLists[7])
ul_prostate <- list(geneLists[4], geneLists[8])
help(rle)
uul_bladder <- unique(unlist(ul_bladder))
ul_bladder <- unique(list(geneLists[1], geneLists[5]))
ul_breast <- unique(list(geneLists[2], geneLists[6]))
ul_liver <- unique(list(geneLists[3], geneLists[7]))
ul_prostate <- unique(list(geneLists[4], geneLists[8]))
ul_bladder <- unique(unlist(list(geneLists[1], geneLists[5])))
ul_breast <- unique(unlist(list(geneLists[2], geneLists[6])))
ul_liver <- unique(unlist(list(geneLists[3], geneLists[7])))
ul_prostate <- unique(unlist(list(geneLists[4], geneLists[8])))
union_lists <- list(ul_bladder, ul_breast, ul_liver, ul_prostate)
help(list)
names(union_lists) <- c("ul_bladder", "ul_breast", "ul_liver", "ul_prostate")
u_fileNames <- c("u_bladder.txt", "u_breast.txt", "u_liver.txt", "u_prostate.txt")
getwd()
setwd("C:/Users/david/Documents/GitHub/TCGAvsHPA/intermediate_data/union_lists")
lapply(1:4, function(x){write.table(union_lists[x], file=u_fileNames[x], sep="\t", col.names = FALSE, row.names = FALSE)})
